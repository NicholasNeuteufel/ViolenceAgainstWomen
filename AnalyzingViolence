#Convert country names to ISO2 codes to easily download World Development Indicators (WDI) data
#Use WDI data to analyze correlates of gender and children violence
#Data here are "total." Download here: https://www.dropbox.com/s/83hos4ry10fx234/GlobalData.csv?dl=0

total <- read.csv(file="GlobalData.csv", h=T, sep=",")

library(countrycode)

total$ISO2 <- countrycode(sourcevar=total$Country, origin="country.name", destination="iso2c", warn=T)

#Need to manually do 3 countries
total$ISO2[total$Country=="DRC"] <- "CD"
total$ISO2[total$Country=="Samoa"] <- "WS"
total$ISO2[total$Country=="Namibia"] <- "NA"

#Add WDI data from WDI package

library(WDI)

#I will save you some pain pre-WDI data.
#Need to drop 2 more countries because they are not recognized WDI-wise. Now 89 countries
new.total <- subset(total, total$ISO2 != "NA")

#Now for the data-scraping

#I begin with per capita GDP, adjusted for purchasing power parity (PPP)
GDP.PPP.per.cap <- WDI(country=new.total$ISO2, indicator="NY.GDP.PCAP.PP.CD", start=2013, end=2013, extra=F, cache=NULL)

#Total health expenditure as a percentage of GDP
Health.Spending <- WDI(country=new.total$ISO2, indicator="SH.XPD.TOTL.ZS", start=2013, end=2013, extra=F, cache=NULL)

#Percentage of population (15+), 15+, female, no education
Female.No.Education <- WDI(country=new.total$ISO2, indicator="BAR.NOED.15UP.FE.ZS", start=2013, end=2013, extra=F, cache=NULL)

#Percentage of female students.  Post-secondary non-tertiary education
Female.PostSecondaryEdu <- WDI(country=new.total$ISO2, indicator="UIS.FEP.4", start=2013, end=2013, extra=F, cache=NULL)

#Survival rate to grade 4.  Female
Female.Grade4Survival <- WDI(country=new.total$ISO2, indicator="UIS.SR.1.G4.F", start=2013, end=2013, extra=F, cache=NULL)

#Labor force, female (% of total labor force)
Female.LaborForcePercentage <- WDI(country=new.total$ISO2, indicator="SL.TLF.TOTL.FE.ZS", start=2013, end=2013, extra=F, cache=NULL)

#Ratio of female to male labor force participation rate (%)
LaborForceParticipationRatio <- WDI(country=new.total$ISO2, indicator="SL.TLF.CACT.FM.ZS", start=2013, end=2013, extra=F, cache=NULL)

#Expected primary completion rate, female (% of population at theoretical entrance age)
ExpectedPrimaryCompletion <- WDI(country=new.total$ISO2, indicator="SE.PRM.EPCR.FE.ZS", start=2013, end=2013, extra=F, cache=NULL)

#MICS: Gini coefficient of average years of schooling. Age 15+. Rural
RuralEduDivide <- WDI(country=new.total$ISO2, indicator="HH.MICS.YRS.15UP.GIN.R", start=2013, end=2013, extra=F, cache=NULL)

#Gini index
GiniIndex <- WDI(country=new.total$ISO2, indicator="SI.POV.GINI", start=2013, end=2013, extra=F, cache=NULL)
